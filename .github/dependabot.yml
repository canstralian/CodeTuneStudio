version: 2

updates:
  # ------------------------------------------------------
  # Python / Pip ecosystem
  # ------------------------------------------------------
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "06:00"
      timezone: "Etc/UTC"
    open-pull-requests-limit: 5
    versioning-strategy: "increase"   # Avoid sudden major jumps unless allowed
    allow:
      - dependency-type: "all"
    ignore:
      - dependency-name: "django"
        versions: ["<3.2"]
      - dependency-name: "flask"
        update-types: ["version-update:semver-major"]
    groups:
      flask-ecosystem:
        patterns:
          - "flask"
          - "flask-*"
          - "werkzeug"
          - "jinja2"
      security-packages:
        patterns:
          - "cryptography"
          - "pyjwt"
          - "bcrypt"
          - "passlib"
      testing:
        patterns:
          - "pytest"
          - "pytest-*"
          - "coverage"
          - "mock"
      numerical-stack:
        patterns:
          - "numpy"
          - "pandas"
          - "pydantic*"
          - "scipy"
          - "scikit*"
    assignees:
      - "canstralian"
    reviewers:
      - "canstralian"
    labels:
      - "dependencies"
      - "python"
      - "auto-update"
    commit-message:
      prefix: "build(deps):"
      include: "scope"
    rebase-strategy: "auto"
    pull-request-branch-name:
      separator: "-"

  # ------------------------------------------------------
  # GitHub Actions ecosystem
  # ------------------------------------------------------
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "06:00"
      timezone: "Etc/UTC"
    open-pull-requests-limit: 3
    groups:
      github-core:
        patterns:
          - "actions/*"
          - "github/*"
      ci-helpers:
        patterns:
          - "*cache*"
          - "*artifact*"
          - "*upload*"
    labels:
      - "github-actions"
      - "ci"
      - "auto-update"
    assignees:
      - "canstralian"
    reviewers:
      - "canstralian"
    commit-message:
      prefix: "ci:"
      include: "scope"
    rebase-strategy: "auto"
    pull-request-branch-name:
      separator: "-"

  # ------------------------------------------------------
  # Node ecosystem (React + toolchain)
  # ------------------------------------------------------
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "07:00"
      timezone: "Etc/UTC"
    open-pull-requests-limit: 5
    versioning-strategy: "increase"
    ignore:
      - dependency-name: "react"
        update-types: ["version-update:semver-major"]
      - dependency-name: "react-dom"
        update-types: ["version-update:semver-major"]
    groups:
      react-ecosystem:
        patterns:
          - "react"
          - "react-*"
          - "@testing-library/*"
      build-tools:
        patterns:
          - "webpack"
          - "webpack-*"
          - "babel"
          - "babel-*"
          - "vite"
      security-js:
        patterns:
          - "jsonwebtoken"
          - "bcryptjs"
          - "helmet"
    labels:
      - "dependencies"
      - "javascript"
      - "react"
      - "auto-update"
    assignees:
      - "canstralian"
    reviewers:
      - "canstralian"
    commit-message:
      prefix: "build(deps):"
      include: "scope"
    rebase-strategy: "auto"
    pull-request-branch-name:
      separator: "-"

  # ------------------------------------------------------
  # Docker ecosystem
  # ------------------------------------------------------
  - package-ecosystem: "docker"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "08:00"
      timezone: "Etc/UTC"
    open-pull-requests-limit: 2
    groups:
      base-images:
        patterns:
          - "*python*"
          - "*node*"
          - "*alpine*"
      security-hardened:
        patterns:
          - "*slim*"
          - "*distroless*"
    labels:
      - "docker"
      - "infrastructure"
    assignees:
      - "canstralian"
    reviewers:
      - "canstralian"
    commit-message:
      prefix: "build(docker):"
      include: "scope"
    rebase-strategy: "auto"
    pull-request-branch-name:
      separator: "-"